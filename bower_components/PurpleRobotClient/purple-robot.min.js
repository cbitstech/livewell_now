!function(){function a(a){a=a||{},this.className="PurpleRobot",this._serverUrl=a.serverUrl||"http://localhost:12345/json/submit",this._script=a.script||""}function b(a,b,c){this.methodName=a,this.argument=b,this.expectedArgument=c,this.message=' received an unexpected argument "',this.toString=function(){return["PurpleRobot.",this.methodName,this.message,this.argument,'" expected: ',this.expectedArgument].join("")}}function c(a){return"'"+a+"'"}a.apiVersion="1.6.8.0",a.setEnvironment=function(a){if("production"!==a&&"debug"!==a&&"web"!==a)throw new b("setEnvironment",a,'["production", "debug", "web"]');return this.env=a,this},a.prototype.toString=function(){return this._script},a.prototype.toStringExpression=function(){return"(function() { return "+this._script+" })()"},a.prototype.toJson=function(){return JSON.stringify(this.toString())},a.prototype.execute=function(b){function c(){b&&e.readyState===XMLHttpRequest.DONE&&(null===e.response&&"function"==typeof b.fail?b.fail():b.done&&b.done(JSON.parse(e.response).payload))}var d=JSON.stringify({command:"execute_script",script:this.toString()});if("web"!==a.env){var e=new XMLHttpRequest;e.onreadystatechange=c;var f=!0;e.open("POST",this._serverUrl,f),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e.send("json="+d)}else console.log('PurpleRobot POSTing to "'+this._serverUrl+'": '+d)},a.prototype.save=function(){return localStorage.prQueue=localStorage.prQueue||"",localStorage.prQueue+=this.toString(),this},a.prototype.restore=function(){return localStorage.prQueue=localStorage.prQueue||"",this._script=localStorage.prQueue,this},a.prototype.destroy=function(){return delete localStorage.prQueue,this},a.prototype.isEqual=function(b,c){var d=this._stringify(b)+" == "+this._stringify(c);return new a({serverUrl:this._serverUrl,script:[this._script,d].join(" ").trim()})},a.prototype.ifThenElse=function(b,c,d){var e="if ("+b.toString()+") { "+c.toString()+" } else { "+d.toString()+" }";return new a({serverUrl:this._serverUrl,script:[this._script,e].join(" ").trim()})},a.prototype.doNothing=function(){return new a({serverUrl:this._serverUrl,script:this._script})},a.prototype.addNamespace=function(a){return this._push("addNamespace",[c(a)].join(", "))},a.prototype.broadcastIntent=function(a,b){return this._push("broadcastIntent",[c(a),JSON.stringify(b||null)].join(", "))},a.prototype.cancelScriptNotification=function(){return this._push("cancelScriptNotification")},a.prototype.clearNativeDialogs=function(a){return a?this._push("clearNativeDialogs",c(a)):this._push("clearNativeDialogs")},a.prototype.clearTriggers=function(){return this._push("clearTriggers")},a.prototype.dateFromTimestamp=function(a){return this._push("dateFromTimestamp",a)},a.prototype.deleteTrigger=function(a){return this._push("deleteTrigger",c(a))},a.prototype.disableEachProbe=function(){return this._push("disableEachProbe")},a.prototype.disableProbes=function(){return this._push("disableProbes")},a.prototype.disableTrigger=function(a){return this._push("disableTrigger",c(a))},a.prototype.emitReading=function(a,b){return this._push("emitReading",c(a)+", "+JSON.stringify(b))},a.prototype.emitToast=function(a,b){return b="boolean"==typeof b?b:!0,this._push("emitToast",c(a)+", "+b)},a.prototype.enableProbes=function(){return this._push("enableProbes")},a.prototype.enableTrigger=function(a){return this._push("enableTrigger",c(a))},a.prototype.fetchConfig=function(){return this._push("fetchConfig")},a.prototype.fetchEncryptedString=function(a,b){return"undefined"==typeof b?this._push("fetchEncryptedString",c(a)):this._push("fetchEncryptedString",c(b)+", "+c(a))},a.prototype.fetchNamespace=function(a){return this._push("fetchNamespace",[c(a)].join(", "))},a.prototype.fetchNamespaces=function(){return this._push("fetchNamespaces")},a.prototype.fetchTrigger=function(a){return this._push("fetchTrigger",[c(a)].join(", "))},a.prototype.fetchTriggerIds=function(){return this._push("fetchTriggerIds")},a.prototype.fetchUserId=function(){return this._push("fetchUserId")},a.prototype.fetchWidget=function(a){return this._push("fetchWidget",c(a))},a.prototype.fireTrigger=function(a){return this._push("fireTrigger",c(a))},a.prototype.formatDate=function(){throw new error("There is no formatDate function on PR client")},a.prototype.getUploadUrl=function(){return this._push("getUploadUrl")},a.prototype.launchApplication=function(a){return this._push("launchApplication",c(a))},a.prototype.launchInternalUrl=function(a){return this._push("launchInternalUrl",[c(a)].join(", "))},a.prototype.launchUrl=function(a){return this._push("launchUrl",c(a))},a.prototype.loadLibrary=function(a){return this._push("loadLibrary",c(a))},a.prototype.log=function(a,b){return this._push("log",c(a)+", "+JSON.stringify(b))},a.prototype.models=function(){throw new Error("PurpleRobot.prototype.models not implemented yet")},a.prototype.now=function(){return this._push("now")},a.prototype.packageForApplicationName=function(a){return this._push("packageForApplicationName",[c(a)].join(", "))},a.prototype.parseDate=function(){throw new Error("PurpleRobot.prototype.parseDate not implemented yet")},a.prototype.persistEncryptedString=function(a,b,d){return"undefined"==typeof d?this._push("persistEncryptedString",c(a)+", "+c(b)):this._push("persistEncryptedString",c(d)+", "+c(a)+", "+c(b))},a.prototype.persistString=function(a,b,d){return"undefined"==typeof d?this._push("persistString",c(a)+", "+c(b)):this._push("persistString",c(d)+", "+c(a)+", "+c(b))},a.prototype.playDefaultTone=function(a){return"boolean"!=typeof a&&(a=!1),this._push("playDefaultTone",a)},a.prototype.playTone=function(a){return this._push("playTone",c(a))},a.prototype.predictions=function(){throw new Error("PurpleRobot.prototype.predictions not implemented yet")},a.prototype.readings=function(){throw new Error("PurpleRobot.prototype.readings not implemented yet")},a.prototype.readUrl=function(a){return this._push("readUrl",c(a))},a.prototype.resetTrigger=function(a){return this._push("resetTrigger",c(a))},a.prototype.runScript=function(a){return this._push("runScript",a.toJson())},a.prototype.scheduleScript=function(a,b,d){var e="(function() { var now = new Date(); var scheduled = new Date(now.getTime() + "+b+" * 60000); var pad = function(n) { return n < 10 ? '0' + n : n; }; return '' + scheduled.getFullYear() + pad(scheduled.getMonth() + 1) + pad(scheduled.getDate()) + 'T' + pad(scheduled.getHours()) + pad(scheduled.getMinutes()) + pad(scheduled.getSeconds()); })()";return this._push("scheduleScript",c(a)+", "+e+", "+d.toJson())},a.prototype.setUploadUrl=function(a){return this._push("setUploadUrl",c(a))},a.prototype.setUserId=function(a){return this._push("setUserId",c(a))},a.prototype.showApplicationLaunchNotification=function(){throw new Error("PurpleRobot.prototype.showApplicationLaunchNotification not implemented yet")},a.prototype.showNativeDialog=function(a){var b=[c(a.title),c(a.message),c(a.buttonLabelA),c(a.buttonLabelB),a.scriptA.toJson(),a.scriptB.toJson()];return void 0!==a.tag&&void 0!==a.priority&&(b=b.concat([JSON.stringify(a.tag),a.priority])),this._push("showNativeDialog",b.join(", "))},a.prototype.showScriptNotification=function(a){return a=a||{},this._push("showScriptNotification",[c(a.title),c(a.message),a.isPersistent,a.isSticky,a.script.toJson()].join(", "))},a.prototype.stopPlayback=function(){return this._push("stopPlayback")},a.prototype.updateConfig=function(a){return this._push("updateConfig",[JSON.stringify(a)].join(", "))},a.prototype.updateConfigUrl=function(a){return this._push("updateConfigUrl",c(a))},a.prototype.updateProbe=function(a){return this._push("updateProbe",JSON.stringify(a))},a.prototype.updateTrigger=function(a){function b(a){function b(a){return a.getFullYear()}function c(a){return("0"+parseInt(1+a.getMonth())).slice(-2)}function d(a){return("0"+parseInt(a.getDate())).slice(-2)}function e(a){return("0"+a.getHours()).slice(-2)}function f(a){return("0"+a.getMinutes()).slice(-2)}function g(a){return("0"+a.getSeconds()).slice(-2)}return b(a)+c(a)+d(a)+"T"+e(a)+f(a)+g(a)}a=a||{};var d=(new Date).getTime(),e=a.triggerId||"TRIGGER-"+d,f=JSON.stringify({type:a.type||"datetime",name:e,identifier:e,action:a.script.toString(),datetime_start:b(a.startAt),datetime_end:b(a.endAt),datetime_repeat:a.repeatRule||"FREQ=DAILY;INTERVAL=1",datetime_random:a.random===!0||!1,fire_on_boot:!0&&a.fire_on_boot!==!1});return this._push("updateTrigger",c(e)+", "+f)},a.prototype.updateWidget=function(){throw new Error("PurpleRobot.prototype.updateWidget not implemented yet")},a.prototype.version=function(){return this._push("version")},a.prototype.vibrate=function(a,b){return a=a||"buzz","boolean"!=typeof b&&(b=!1),this._push("vibrate",c(a)+", "+b)},a.prototype.widgets=function(){throw new Error("PurpleRobot.prototype.widgets not implemented yet")},a.prototype._push=function(b,c){var d=["PurpleRobot.",b,"(",c,");"].join("");return new a({serverUrl:this._serverUrl,script:[this._script,d].join(" ").trim()})},a.prototype._stringify=function(a){var b;return b=null!==a&&"object"==typeof a&&a.className===this.className?a.toStringExpression():JSON.stringify(a)},window.PurpleRobot=a}();
//# sourceMappingURL=purple-robot.min.js.map